# Supabase Email Redirect Configuration

## The Problem
When users click the verification link in their email, they're being redirected to localhost instead of your Render deployment.

## The Solution

### 1. Update Supabase Dashboard Settings

Go to your Supabase project dashboard:

1. Navigate to **Authentication** → **URL Configuration**
2. Update these URLs:

   **Site URL**:
   ```
   https://pam-7xeo.onrender.com
   ```

   **Redirect URLs** (add all of these):
   ```
   https://pam-7xeo.onrender.com
   https://pam-7xeo.onrender.com/auth/callback
   https://pam-7xeo.onrender.com/onboarding
   https://pam-7xeo.onrender.com/dashboard/today
   http://localhost:3000
   http://localhost:3000/auth/callback
   ```

3. Save the changes

### 2. Update Email Templates (Optional but Recommended)

In Supabase Dashboard:

1. Go to **Authentication** → **Email Templates**
2. Click on **Confirm signup** template
3. Update the template to use your custom domain:

   Change:
   ```html
   <a href="{{ .ConfirmationURL }}">Confirm your email</a>
   ```

   To:
   ```html
   <a href="{{ .ConfirmationURL }}" style="background-color: #7D0820; color: white; padding: 12px 24px; text-decoration: none; border-radius: 8px; display: inline-block;">Verify Email & Get Started</a>
   ```

### 3. Environment Variables

Make sure your Render deployment has:
```
NEXT_PUBLIC_APP_URL=https://pam-7xeo.onrender.com
```

### 4. Testing

After making these changes:

1. Clear your browser cache
2. Try signing up with a new email
3. The verification email should now redirect to your Render URL

## Important Notes

- The redirect URL in the email is generated by Supabase, not your app
- The `emailRedirectTo` option in the code helps, but Supabase dashboard settings take precedence
- Always include both www and non-www versions if using a custom domain
- Include localhost URLs for development

## Troubleshooting

If emails still redirect to localhost:

1. **Check Supabase Logs**: Go to Logs → Auth in Supabase dashboard
2. **Verify Email Template**: Make sure you're not using a custom template with hardcoded localhost
3. **Clear Cache**: Sometimes Supabase caches redirect URLs
4. **Check Environment**: Ensure `NEXT_PUBLIC_APP_URL` is set in Render

## For Your Founders Testing

Once configured, your founders can:
1. Sign up at https://pam-7xeo.onrender.com/signup
2. Check their email
3. Click the verification link
4. Be redirected to https://pam-7xeo.onrender.com (not localhost)
5. Complete onboarding
6. Start using PAM!

## Additional Security

For production, also add to Redirect URLs:
- Your custom domain (when you have one)
- Any staging environments
- Remove localhost URLs once in production