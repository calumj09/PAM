# PAM Backend

Go-based backend services for the PAM (Parent Admin Manager) ecosystem.

## Setup

1. **Install Go tools:**
   ```bash
   make install-tools
   ```

2. **Set up environment:**
   ```bash
   cp .env.example .env
   # Edit .env with your configuration
   ```

3. **Run quality checks:**
   ```bash
   make quality-check
   ```

## Development

### Quality System

All backend development follows the SuperClaude workflow defined in:
`PAM/documentation/workflows/backend-workflow/backend_workflow_command.md`

#### Quality Commands

- `make quality-check` - Run all quality checks
- `make quality-fix` - Apply automatic fixes
- `make quality-report` - Generate detailed coverage report
- `make test-coverage` - Check test coverage (≥80% required)
- `make analyze-performance` - Performance analysis

#### Quality Standards (9/10 Required)

- **Code Quality (25%):** go vet, staticcheck, golangci-lint compliance
- **Test Coverage (25%):** ≥80% coverage with go test
- **Security (25%):** gosec scanning, input validation, auth checks
- **Performance (25%):** Response times <200ms, efficient database queries

### Project Configuration

The project is configured in `project.config`:

- **Project Type:** greenfield (new project)
- **Database:** PostgreSQL (via Supabase)
- **Deployment:** AWS Serverless (Lambda + API Gateway)
- **Migration:** None needed (new project)

### Backend Workflow

To build new backend features using SuperClaude:

```bash
# In Claude Code, use one of these trigger phrases:
build backend for [feature]
create API for [feature]
implement backend [feature]
add backend [feature]
```

This will trigger the comprehensive backend development workflow with automatic quality gates.

## Architecture

### Tech Stack

- **Runtime:** Go 1.24+
- **Framework:** Standard library HTTP server
- **Database:** PostgreSQL (via Supabase)
- **Authentication:** Supabase Auth
- **Deployment:** AWS Lambda + API Gateway
- **Quality:** Comprehensive Go toolchain

### Performance Budgets

- **API Response Time:** <200ms (99th percentile)
- **Database Query Time:** <50ms average
- **Lambda Cold Start:** <500ms
- **Memory Usage:** <128MB per function
- **Concurrent Connections:** Handle 1000+ simultaneous requests

### Security

- **Server Timeouts:** Read/Write/Idle timeouts configured
- **Input Validation:** All endpoints validated
- **Authentication:** JWT-based auth via Supabase
- **CORS:** Configured for web and mobile apps
- **Static Analysis:** gosec security scanning

## Testing

```bash
# Run tests
go test ./...

# Run tests with coverage
make test-coverage

# Run tests with race detection
go test -race ./...

# Generate coverage report
make quality-report
```

## Deployment

The backend is designed for AWS serverless deployment:

1. **SAM Template:** Generated by SuperClaude workflow
2. **API Gateway:** RESTful API endpoints
3. **Lambda Functions:** Individual functions per feature
4. **Environment:** Development, staging, production

## Development Workflow

1. **Feature Request:** Define requirements in PRD format
2. **SuperClaude Workflow:** Trigger backend workflow
3. **Quality Gates:** Must achieve 9/10 quality score
4. **Testing:** Comprehensive test coverage
5. **Deployment:** AWS serverless deployment

## Monitoring

- **Health Endpoint:** `/health` for service status
- **Metrics:** AWS CloudWatch integration
- **Logging:** Structured logging with levels
- **Alerts:** Error rate and performance monitoring